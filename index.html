<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width"/>
    <title>Bridge calc</title>
    <style>
        body {background-color: cadetblue;
            color: #ffffff;
            height: 100vh;
            font-size: 18px;
        }
        h1   {color: blue;}
        p    {color: red;}
        .root{
            margin: 0 auto;
            width: fit-content;
        }
        button {
            border: none;
            padding: 6px 14px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            cursor: pointer;
            font-size: 1.3rem;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            transition: all .3s ease;
            background: #fff;
            border-radius: 5px;
        }
        button:hover{
            background: #ccc;
        }
        button.active {background-color: #54FF9F;}
        .suit-red {color: red;}
        .suit-black {color: black;}
        .no-trump{color: #112df3;
            font-size: 1.5rem;
        }
        .bid-table{
            width:fit-content;
            margin: 0 auto;
            text-align: center;
        }
        .flex{
            display: flex;
            flex-direction: row;
            flex-wrap: nowrap;
            align-content: center;
            justify-content: center;
            align-items: center;
            margin: 0 auto;
            padding: 5px;
        }
        .margin-0-5{
            margin: 0 5px;
        }
        .padding-0-20{
            padding: 0 20px;
        }
        .sum{
            border-top: 5px solid #000;
            margin-top: 10px;
            font-size: 30px;
            color: #fff;
        }
    </style>
</head>
<body>

<div class="root">
    <table class="bid-table">
        <tr>
            <td><button class="js-change-bid active" data-bid="1C">1<span class="suit-black">&#9827;</span></button></td>
            <td><button class="js-change-bid" data-bid="1D">1<span class="suit-red">&#9830;</span></button></td>
            <td><button class="js-change-bid" data-bid="1H">1<span class="suit-red">&#9829;</span></button></td>
            <td><button class="js-change-bid" data-bid="1S">1<span class="suit-black">&#9824;</span></button></td>
            <td><button class="js-change-bid" data-bid="1NT">1<span class="no-trump">×</span></button></td>
        </tr>
        <tr>
            <td><button class="js-change-bid" data-bid="2C">2<span class="suit-black">&#9827;</span></button></td>
            <td><button class="js-change-bid" data-bid="2D">2<span class="suit-red">&#9830;</span></button></td>
            <td><button class="js-change-bid" data-bid="2H">2<span class="suit-red">&#9829;</span></button></td>
            <td><button class="js-change-bid" data-bid="2S">2<span class="suit-black">&#9824;</span></button></td>
            <td><button class="js-change-bid" data-bid="2NT">2<span class="no-trump">×</span></button></td>
        </tr>
        <tr>
            <td><button class="js-change-bid" data-bid="3C">3<span class="suit-black">&#9827;</span></button></td>
            <td><button class="js-change-bid" data-bid="3D">3<span class="suit-red">&#9830;</span></button></td>
            <td><button class="js-change-bid" data-bid="3H">3<span class="suit-red">&#9829;</span></button></td>
            <td><button class="js-change-bid" data-bid="3S">3<span class="suit-black">&#9824;</span></button></td>
            <td><button class="js-change-bid" data-bid="3NT">3<span class="no-trump">×</span></button></td>
        </tr>
        <tr>
            <td><button class="js-change-bid" data-bid="4C">4<span class="suit-black">&#9827;</span></button></td>
            <td><button class="js-change-bid" data-bid="4D">4<span class="suit-red">&#9830;</span></button></td>
            <td><button class="js-change-bid" data-bid="4H">4<span class="suit-red">&#9829;</span></button></td>
            <td><button class="js-change-bid" data-bid="4S">4<span class="suit-black">&#9824;</span></button></td>
            <td><button class="js-change-bid" data-bid="4NT">4<span class="no-trump">×</span></button></td>
        </tr>
        <tr>
            <td><button class="js-change-bid" data-bid="5C">5<span class="suit-black">&#9827;</span></button></td>
            <td><button class="js-change-bid" data-bid="5D">5<span class="suit-red">&#9830;</span></button></td>
            <td><button class="js-change-bid" data-bid="5H">5<span class="suit-red">&#9829;</span></button></td>
            <td><button class="js-change-bid" data-bid="5S">5<span class="suit-black">&#9824;</span></button></td>
            <td><button class="js-change-bid" data-bid="5NT">5<span class="no-trump">×</span></button></td>
        </tr>
        <tr>
            <td><button class="js-change-bid" data-bid="6C">6<span class="suit-black">&#9827;</span></button></td>
            <td><button class="js-change-bid" data-bid="6D">6<span class="suit-red">&#9830;</span></button></td>
            <td><button class="js-change-bid" data-bid="6H">6<span class="suit-red">&#9829;</span></button></td>
            <td><button class="js-change-bid" data-bid="6S">6<span class="suit-black">&#9824;</span></button></td>
            <td><button class="js-change-bid" data-bid="6NT">6<span class="no-trump">×</span></button></td>
        </tr>
        <tr>
            <td><button class="js-change-bid" data-bid="7C">7<span class="suit-black">&#9827;</span></button></td>
            <td><button class="js-change-bid" data-bid="7D">7<span class="suit-red">&#9830;</span></button></td>
            <td><button class="js-change-bid" data-bid="7H">7<span class="suit-red">&#9829;</span></button></td>
            <td><button class="js-change-bid" data-bid="7S">7<span class="suit-black">&#9824;</span></button></td>
            <td><button class="js-change-bid" data-bid="7NT">7<span class="no-trump">×</span></button></td>
        </tr>
    </table>
    <div class="flex">
        <button class="js-change-double margin-0-5" data-type="double">Double</button>
        <button class="js-change-double margin-0-5" data-type="redouble">Redouble</button>
    </div>
    <div class="flex">
        <button class="js-change-double" data-type="zone">Vulnerable</button>
    </div>
    <div class="flex">
        <button class="js-change-team margin-0-5 active" data-team="team1">Team 1</button>
        <button class="js-change-team margin-0-5" data-team="team2">Team 2</button>
    </div>
    <div class="flex">
        <button class="js-change-count" data-add="-1">-</button>
        <span class="js-current-count padding-0-20">0</span>
        <button class="js-change-count" data-add="1">+</button>
    </div>
    <div class="flex">
        <button class="js-result">COUNT</button>
    </div>
    <table class="bid-table sum">
    <tr>
        <td><span class="js-result">Team 1</span></td>
        <td><span class="js-result">Team 2</span></td>
    </tr>
    <tr>
        <td><span class="js-result-team1-bonus">0</span></td>
        <td><span class="js-result-team2-bonus">0</span></td>
    </tr>
    <tr>
        <td><span class="js-result-team1-score">0</span></td>
        <td><span class="js-result-team2-score">0</span></td>
    </tr>
</table>
</div>

</body>

<script type="text/javascript">

let bids = {
    "1C": {c: 7, s: 20, b: 20},"1D": {c: 7, s: 20, b: 20},"1H": {c: 7, s: 30, b: 30},"1S": {c: 7, s: 30, b: 30},"1NT": {c: 7, s: 40, b: 30},
    "2C": {c: 8, s: 40, b: 20},"2D": {c: 8, s: 40, b: 20},"2H": {c: 8, s: 60, b: 30},"2S": {c: 8, s: 60, b: 30},"2NT": {c: 8, s: 70, b: 30},
    "3C": {c: 9, s: 60, b: 20},"3D": {c: 9, s: 60, b: 20},"3H": {c: 9, s: 90, b: 30},"3S": {c: 9, s: 90, b: 30},"3NT": {c: 9, s: 100, b: 30},
    "4C": {c: 10, s: 80, b: 20},"4D": {c: 10, s: 80, b: 20},"4H": {c: 10, s: 120, b: 30},"4S": {c: 10, s: 120, b: 30},"4NT": {c: 10, s: 130, b: 30},
    "5C": {c: 11, s: 100, b: 20},"5D": {c: 11, s: 100, b: 20},"5H": {c: 11, s: 150, b: 30},"5S": {c: 11, s: 150, b: 30},"5NT": {c: 11, s: 160, b: 30},
    "6C": {c: 12, s: 120, b: 20},"6D": {c: 12, s: 120, b: 20},"6H": {c: 12, s: 180, b: 30},"6S": {c: 12, s: 180, b: 30},"6NT": {c: 12, s: 190, b: 30},
    "7C": {c: 13, s: 140, b: 20},"7D": {c: 13, s: 140, b: 20},"7H": {c: 13, s: 210, b: 30},"7S": {c: 13, s: 210, b: 30},"7NT": {c: 13, s: 220, b: 30},
}
let bonuses = {
    insult: 50,
    slam: {
        nozone: 500,
        zone: 750,
    },
    grandSlam: {
        nozone: 1000,
        zone: 1500,
    },
    double: {
        nozone: [100, 200, 200, 300],
        zone: [200, 300],
        nozoneOver: 100,
        zoneOver: 200,
    },
    common: {
        nozone: 50,
        zone: 100,
    },
}
let game = {
    bid: "1C",
    zone: false,
    double: false,
    redouble: false,
    count: 0,
    team: "team1",
    enemy: "",
    team1: {score: 0, bonus: 0},
    team2: {score: 0, bonus: 0}
}

// pick bid
let bidButtons = document.getElementsByClassName('js-change-bid');
for (var i = 0; i < bidButtons.length; i++) {
    bidButtons[i].addEventListener('click', changeBid);
}

function changeBid(e){
    let bidButton = e.currentTarget;
    for (var i = 0; i < bidButtons.length; i++) {
        bidButtons[i].classList.remove("active");
    }
    bidButton.classList.add("active");
    game.bid = bidButton.getAttribute("data-bid");
}

// pick count
let countButtons = document.getElementsByClassName('js-change-count');
for (var i = 0; i < countButtons.length; i++) {
    countButtons[i].addEventListener('click', changeCount);
}

function changeCount(e){
    let countButton = e.currentTarget;
    game.count += parseInt(countButton.getAttribute("data-add"));
    game.count = Math.min(Math.max(game.count, 0), 13);
    document.getElementsByClassName('js-current-count')[0].innerHTML = game.count;
}

// pick double
let doubleButtons = document.getElementsByClassName('js-change-double');
for (var i = 0; i < doubleButtons.length; i++) {
    doubleButtons[i].addEventListener('click', changeDouble);
}

function changeDouble(e){
    let doubleButton = e.currentTarget,
        doubleType = doubleButton.getAttribute("data-type");
    if(doubleType === 'double'){
        if(game.double){
            game.double = false;
        } else {
            game.redouble = false;
            game.double = true;
        }
    }
    if(doubleType === 'redouble'){
        if(game.redouble){
            game.redouble = false;
        } else {
            game.double = false;
            game.redouble = true;
        }
    }
    if(doubleType === 'zone'){
        game.zone = !game.zone;
    }
    for (var i = 0; i < doubleButtons.length; i++) {
        if(game[doubleButtons[i].getAttribute("data-type")]){
            doubleButtons[i].classList.add("active");
        } else {
            doubleButtons[i].classList.remove("active");
        }
    }
}

// pick team
let teamButtons = document.getElementsByClassName('js-change-team');
for (var i = 0; i < teamButtons.length; i++) {
    teamButtons[i].addEventListener('click', changeTeam);
}

function changeTeam(e){
    let teamButton = e.currentTarget;
    for (var i = 0; i < teamButtons.length; i++) {
        teamButtons[i].classList.remove("active");
    }
    teamButton.classList.add("active");
    game.team = teamButton.getAttribute("data-team");
}

// count result
document.getElementsByClassName('js-result')[0].addEventListener('click', recount);

function recount(){
    let bid = bids[game.bid]
    game.enemy = game.team === "team1" ? "team2" : "team1";
    game.team1 = {score: 0, bonus: 0}
    game.team2 = {score: 0, bonus: 0}

    // normal game
    if(!game.double && !game.redouble){
        let bonus = game.zone ? bonuses.common.zone : bonuses.common.nozone;
        // win
        if(game.count >= bid.c){
            game[game.team].score = bid.s;
            game[game.team].bonus = bid.b*(game.count - bid.c);
            if(bid.c === 12){
                game[game.team].bonus += game.zone ? bonuses.slam.zone : bonuses.slam.nozone;
            } else if(bid.c === 13){
                game[game.team].bonus += game.zone ? bonuses.grandSlam.zone : bonuses.grandSlam.nozone;
            }
        // lose        
        } else {
            game[game.enemy].bonus = bonus*(bid.c - game.count);
        }
    // double game
    } else {
        let scoreM = game.redouble ? 4 : 2,
            overM = game.redouble ? 2 : 1;
        // win
        if(game.count >= bid.c){
            let over = game.zone ? bonuses.double.zoneOver : bonuses.double.nozoneOver;
            game[game.team].score = scoreM*bid.s;
            game[game.team].bonus = overM*over*(game.count - bid.c)+overM*bonuses.insult;
            if(bid.c === 12){
                game[game.team].bonus += game.zone ? bonuses.slam.zone : bonuses.slam.nozone;
            } else if(bid.c === 13){
                game[game.team].bonus += game.zone ? bonuses.grandSlam.zone : bonuses.grandSlam.nozone;
            }
        // lose
        } else {
            let bCount = bid.c - game.count;
            if(game.zone){
                let dzBonus = bonuses.double.zone
                game[game.enemy].bonus = overM*(dzBonus[0]*Math.min(Math.max(0,bCount),1)+dzBonus[1]*Math.max(0,bCount-1));
            } else {
                let dnzBonus = bonuses.double.nozone
                game[game.enemy].bonus = overM*(dnzBonus[0]*Math.min(Math.max(0,bCount),1)+dnzBonus[1]*Math.min(Math.max(0,bCount-1),2)+dnzBonus[3]*Math.max(0,bCount-3));
            }
        }
    }

    document.getElementsByClassName('js-result-team1-bonus')[0].innerHTML = game.team1.bonus;
    document.getElementsByClassName('js-result-team2-bonus')[0].innerHTML = game.team2.bonus;
    document.getElementsByClassName('js-result-team1-score')[0].innerHTML = game.team1.score;
    document.getElementsByClassName('js-result-team2-score')[0].innerHTML = game.team2.score;
}

</script>

</html>